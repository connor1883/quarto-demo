<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Fresh Quarto Website - Alcohol Exercise</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Fresh Quarto Website</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./sample.html"> 
<span class="menu-text">sample</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Mermaid Diagrams.html"> 
<span class="menu-text">Mermaid Diagrams</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./Alcohol Exercise.html" aria-current="page"> 
<span class="menu-text">Alcohol Exercise</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#create-a-set-of-folders-to-store-your-work-in" id="toc-create-a-set-of-folders-to-store-your-work-in" class="nav-link" data-scroll-target="#create-a-set-of-folders-to-store-your-work-in">Create a set of folders to store your work in</a>
  <ul class="collapse">
  <li><a href="#create-the-folder-hierarchy-for-this-exercise" id="toc-create-the-folder-hierarchy-for-this-exercise" class="nav-link" data-scroll-target="#create-the-folder-hierarchy-for-this-exercise">Create the folder hierarchy for this exercise</a></li>
  </ul></li>
  <li><a href="#dataset-and-codebook" id="toc-dataset-and-codebook" class="nav-link" data-scroll-target="#dataset-and-codebook">Dataset and Codebook</a>
  <ul class="collapse">
  <li><a href="#download-the-dataset-and-codebook" id="toc-download-the-dataset-and-codebook" class="nav-link" data-scroll-target="#download-the-dataset-and-codebook">Download the dataset and codebook</a></li>
  <li><a href="#examine-the-codebook-and-dataset" id="toc-examine-the-codebook-and-dataset" class="nav-link" data-scroll-target="#examine-the-codebook-and-dataset">Examine the codebook and dataset</a></li>
  </ul></li>
  <li><a href="#general-comments-about-organizing-your-work-and-writing-do-files" id="toc-general-comments-about-organizing-your-work-and-writing-do-files" class="nav-link" data-scroll-target="#general-comments-about-organizing-your-work-and-writing-do-files">General comments about organizing your work and writing do-files</a>
  <ul class="collapse">
  <li><a href="#folder-structure-and-file-locations." id="toc-folder-structure-and-file-locations." class="nav-link" data-scroll-target="#folder-structure-and-file-locations.">Folder structure and file locations.</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Alcohol Exercise</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Revising for markdown publication</p>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In this exercise, you will explore whether there is less drinking among college students who live in alcohol-free housing than among students who do not live in alcohol-free housing.</p>
<p>The data you will use come from a survey of students at American colleges and universities conducted in 2001. The survey focused on alcohol use, but also included questions on many other aspects of college life.</p>
<p>This exercise asks you to use the data from the alcohol survey to create a number of bar graphs, and then answer a series of questions about what the bar graphs suggest about patterns of alcohol use among students that live in alcohol-free housing compared to those who do not.</p>
<p>A critical dimension of this exercise is documenting your work in such a way that everything you do with your data is <strong>transparent</strong> and <strong>reproducible.</strong> In this context, that means several things:</p>
<blockquote class="blockquote">
<p><strong>Writing do-files</strong> containing code that executes every step of data processing and analysis you do to construct the bar graphs—including opening up the file containing the survey data, cleaning and processing the data as necessary, and then generating the bar graphs.</p>
</blockquote>
<p>indicate where files that need to be opened are located and where files that need to be stored should be saved.</p>
<blockquote class="blockquote">
<p><strong>Constructing a Data Appendix</strong> that serves as a codebook or user’s guide to your analysis dataset—the cleaned and processed version of the survey data that you use to generate the bar graphs.</p>
</blockquote>
<blockquote class="blockquote">
<p><strong>Writing a Read Me file</strong> that describes the content and organization of the documentation you create for this exercise, and gives step-by-step instructions for using the documentation to replicate all the data processing you did and to reproduce your bar graphs.</p>
</blockquote>
<p>When you have completed this exercise, you will turn in both a printed report and a set of electronic files you create to document your work.</p>
<section id="create-a-set-of-folders-to-store-your-work-in" class="level2">
<h2 class="anchored" data-anchor-id="create-a-set-of-folders-to-store-your-work-in">Create a set of folders to store your work in</h2>
<p>Decide where you will keep your work. Depending on your preferences and the technology you are using, you may store these folders locally (on the hard disk of a computer you will be using), on a storage server or course management system maintained by your institution, or on-line [using a platform such as the <a href="www.osf.io">Open Science Framework</a>, <a href="www.dropbox.com">Dropbox</a>, or <a href="www.google.com/drive/">Google Drive</a>].</p>
<p>In any case, you should choose a place to store these folders that is secure and that you will be able to access easily while you work on this exercise.</p>
<p>Wherever you store these folders, be sure that there is system in place to automatically back them up, or that you manually maintain an up-to-date set of back-up files at all times.</p>
<p>Create your folders. An essential step toward ensuring that your data processing and analysis are easily reproducible is creating a folder hierarchy—a set of folders (and folders-within-folders) with a well-defined structure—in which you store your data, command files, and accompanying documents. You should create this set of folders at the very beginning of your work—before you even obtain the data you will be using.</p>
<p>You will keep all your files in these folders while you work on this exercise, and when you have finished you will use them to store the electronic documentation that you submit with your printed report.</p>
<section id="create-the-folder-hierarchy-for-this-exercise" class="level3">
<h3 class="anchored" data-anchor-id="create-the-folder-hierarchy-for-this-exercise">Create the folder hierarchy for this exercise</h3>
<p>Make a new folder with the name <code>Your-Name-Alcohol-Exercise</code>, and save it in the location you chose to save your work in. This will be the main folder in which you store all of your work for this exercise.</p>
<p>Next create the following folders and sub-folders:</p>
<pre><code>./Your-Name-Alcohol-Exercise/Original-Data
./Your-Name-Alcohol-Exercise/Command-Files
./Your-Name-Alcohol-Exercise/Graphs</code></pre>
<p>In the <code>/Graphs</code> folder create the following sub-folders</p>
<pre><code>/Graphs/For-Data-Appendix
/Graphs/For-Report</code></pre>
<p>Finally, in the <code>/Original-Data</code> folder create the following subfolder</p>
<pre><code>/Original-Data/Metadata</code></pre>
<p>Your completed folder hierarchy should look like this</p>
<pre><code>./Your-Name-Alcohol-Exercise/Original-Data/Metadata
./Your-Name-Alcohol-Exercise/Command-Files
./Your-Name-Alcohol-Exercise/Graphs/For-Data-Appendix
./Your-Name-Alcohol-Exercise/Graphs/For-Report</code></pre>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Be sure to build this folder hierarchy before you proceed to the next steps of this exercise. Having these folders set up in advance so that you have a place to put the various files you obtain or create while you work on this exercise will help things go smoothly.</p>
</div>
</div>
</div>
</section>
</section>
<section id="dataset-and-codebook" class="level2">
<h2 class="anchored" data-anchor-id="dataset-and-codebook">Dataset and Codebook</h2>
<p>Download and examine the dataset and codebook you will use for this exercise</p>
<p>Find and explore the website where the data for this exercise are stored. The data used in this exercise come from a study titled Harvard School of Public Health College Alcohol Study, 2001. This study is archived at the Inter-University Consortium for Political and Social Research (ICPSR); its ICPSR study number is 4291.</p>
<p>Go to the <a href="www.icpsr.umich.edu">ICPSR website</a> (www.icpsr.umich.edu), and search for this study. When you have found the page for this study, read the information provided there</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Some of the information on the webpage for the dataset may have to do with technical matters you don’t understand or details that may not appear important, but that is OK. Just read through the page and get out of it what you can.</p>
</div>
</div>
</div>
<section id="download-the-dataset-and-codebook" class="level3">
<h3 class="anchored" data-anchor-id="download-the-dataset-and-codebook">Download the dataset and codebook</h3>
<p>Before you can download the data, you need to create an account on the ICPSR website. Once you have done so, log in, go to the main page for the 2001 alcohol study, and click on the “Download” button. You will get a menu of formats to choose from, including SAS, SPSS, Stata, and ASCII. From this menu, select Stata.</p>
<p>The data file will be downloaded in a zipped folder. When you unzip and look inside the folder, you will see that it contains several documents, as well as a subfolder called <code>/DS0001</code> For this exercise, you will need to use only two of the files you downloaded, both of which will be stored in the <code>/DS0001</code> subfolder:</p>
<blockquote class="blockquote">
<p><code>04291-0001-Data.dta</code> This file contains the data from the survey, stored in Stata’s .dta format. This file will be referred to as the “original data file” for this exercise.</p>
</blockquote>
<blockquote class="blockquote">
<p><code>04291-0001-Codebook.pdf</code> This is the codebook for the 2001 alcohol survey. It will be referred to as the “metadata” for the original data file.</p>
</blockquote>
<p>You should save copies of both of these files in the folder hierarchy you created for this exercise.</p>
<p>Save the original data file in the <code>/Original-Data</code> folder.</p>
<p>Save the codebook in the <code>/Metadata</code> folder (which is inside your Original-Data folder).</p>
</section>
<section id="examine-the-codebook-and-dataset" class="level3">
<h3 class="anchored" data-anchor-id="examine-the-codebook-and-dataset">Examine the codebook and dataset</h3>
<p>Examine the codebook and original data file to familiarize yourself with the information they contain.</p>
<p>In particular, by reading the codebook and using Stata to explore the contents of the data, answer the following questions:</p>
<blockquote class="blockquote">
<p>What is the recommended format for citations of this dataset (to use, for example, in a reference list or a list of data sources)?</p>
</blockquote>
<blockquote class="blockquote">
<p>How many observations are there in the dataset?</p>
</blockquote>
<blockquote class="blockquote">
<p>How many variables are there in the dataset?</p>
</blockquote>
<blockquote class="blockquote">
<p>What is the unit of analysis for the dataset?</p>
</blockquote>
<blockquote class="blockquote">
<p>What population was the sample represented in this dataset taken from?</p>
</blockquote>
<p>For this exercise, you will need to use six variables from alcohol study. In the original data file, these variables have the names <code>A6, B8, B9, C13, G6,</code> and <code>G11</code>.</p>
<p>For each of these variables, answer the following questions:</p>
<blockquote class="blockquote">
<p>How is the variable defined, or what does it represent?</p>
</blockquote>
<blockquote class="blockquote">
<p>What units is the variable measured in, or what is the coding scheme?</p>
</blockquote>
<blockquote class="blockquote">
<p>Is it categorical or quantitative?</p>
</blockquote>
<blockquote class="blockquote">
<p>If it is quantitative, find the mean, standard deviation, the three quartiles, the minimum and the maximum.</p>
</blockquote>
<blockquote class="blockquote">
<p>It if is categorical, how many categories are there, what do they represent, and what proportion of the observations fall in each category?</p>
</blockquote>
<blockquote class="blockquote">
<p>For each categorical variable, decide whether the categories are ordered or unordered</p>
</blockquote>
<p>Finally, suppose you wanted know what college or university each student in the sample attended. Would you be able to find that out using the codebook and dataset you downloaded from ICPSR? If so, how would you do so? If not, do you have any idea why that information is not provided?</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You will not need to turn in written answers to these questions, and you will not need to turn in do-files that document this preliminary exploration of your data. However, it is important to convince yourself that you understand all of the questions well. If you are hazy on any of them, you are likely to encounter trouble as you work on the parts of the exercise that you do have to turn in.</p>
</div>
</div>
</div>
</section>
</section>
<section id="general-comments-about-organizing-your-work-and-writing-do-files" class="level2">
<h2 class="anchored" data-anchor-id="general-comments-about-organizing-your-work-and-writing-do-files">General comments about organizing your work and writing do-files</h2>
<section id="folder-structure-and-file-locations." class="level3">
<h3 class="anchored" data-anchor-id="folder-structure-and-file-locations.">Folder structure and file locations.</h3>
<p>Before you begin working on your do-files, make sure that you have created a folder hierarchy as described <a href="https://connor1883.github.io/quarto-demo/Alcohol%20Exercise.html#create-a-set-of-folders-to-store-your-work-in">here</a>, and that you have put the original data and the codebook in the folders specified <a href="https://connor1883.github.io/quarto-demo/Alcohol%20Exercise.html#dataset-and-codebook">here</a>. As you work on this exercise, you will be creating new files of various kinds, and storing them in designated locations in this hierarchy.</p>
<p>Whenever you are working with Stata, a copy of your complete folder hierarchy, with the most up-to-date versions of all your files stored in their designated locations, should be saved on the computer you are working on.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>